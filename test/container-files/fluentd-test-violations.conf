# Test violations rules - policy violation detection
<source>
  @type sample
  sample [
    {"message":"Dec 10 10:53:41 testhost su[12345]: session opened for user root by admin"},
    {"message":"Dec 10 10:53:42 testhost su[67890]: authentication failure; logname=user uid=1000 euid=0 tty=pts/0 ruser=user rhost= user=root"},
    {"message":"Dec 10 10:53:43 testhost sudo[11111]: user admin : TTY=pts/0 ; PWD=/home/admin ; USER=root ; COMMAND=/bin/ls"},
    {"message":"Dec 10 10:53:44 testhost application[22222]: Normal application activity"}
  ]
  tag violations-logcheck.test
  rate 4
  auto_increment_key seq
</source>

<filter violations-logcheck.test>
  @type logcheck
  # Test violations detection rules - should generate ALERTS
  rules_file /etc/logcheck/violations.d/su
</filter>

<match *.**>
  @type copy
  <store>
    @type stdout
  </store>
</match>
