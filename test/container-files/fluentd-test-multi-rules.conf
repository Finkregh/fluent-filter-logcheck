# Test multiple rule types with priority - comprehensive rule precedence testing
<source>
  @type sample
  sample [
    {"message":"Dec 10 10:53:41 testhost kernel: Oversized packet received from 192.168.1.100"},
    {"message":"Dec 10 10:53:42 testhost su[12345]: session opened for user root by admin"},
    {"message":"Dec 10 10:53:43 testhost sshd-session[67890]: Accepted password for user1 from 192.168.1.50 port 22 ssh2"},
    {"message":"Dec 10 10:53:44 testhost sshd-session[11111]: Failed password for invalid user hacker from 192.168.1.200 port 22 ssh2"},
    {"message":"Dec 10 10:53:45 testhost sshd-session[22222]: fatal: recv_rexec_state: ssh_msg_recv failed"},
    {"message":"Dec 10 10:53:46 testhost application[33333]: Normal application message that should pass through"}
  ]
  tag multi-logcheck.test
  rate 6
  auto_increment_key seq
</source>

<filter multi-logcheck.test>
  @type logcheck
  # Test multiple rule sources with different priorities
  <rules>
    path /etc/logcheck/cracking.d
    type cracking
    recursive true
  </rules>
  <rules>
    path /etc/logcheck/violations.d
    type violations
    recursive true
  </rules>
  <rules>
    path /etc/logcheck/ignore.d.server
    type ignore
    recursive true
  </rules>
  # Rule priority: cracking > violations > ignore
  rule_priority ["cracking", "violations", "ignore"]
  # Enable alert metadata
  mark_matches true
  mark_field_prefix "logcheck_"
</filter>

<match *.**>
  @type copy
  <store>
    @type stdout
  </store>
</match>
