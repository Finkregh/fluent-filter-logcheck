# Test SSH ignore rules - SSH message filtering
<source>
  @type sample
  sample [
    {"message":"Dec 10 10:53:41 testhost sshd-session[12345]: Accepted password for user1 from 192.168.1.100 port 22 ssh2"},
    {"message":"Dec 10 10:53:42 testhost sshd-session[67890]: Failed password for invalid user hacker from 192.168.1.200 port 22 ssh2"},
    {"message":"Dec 10 10:53:43 testhost sshd-session[11111]: Connection closed by 192.168.1.150 port 22 [preauth]"},
    {"message":"Dec 10 10:53:44 testhost sshd-session[22222]: fatal: recv_rexec_state: ssh_msg_recv failed"},
    {"message":"Dec 10 10:53:45 testhost someapp[33333]: This message should pass through"}
  ]
  tag ssh-logcheck.ignore
  rate 5
  auto_increment_key seq
</source>

<filter ssh-logcheck.ignore>
  @type logcheck
  # Test SSH ignore rules
  rules_file /etc/logcheck/ignore.d.server/ssh
  debug_mode true
</filter>

<match *.**>
  @type copy
  <store>
    @type stdout
  </store>
</match>
